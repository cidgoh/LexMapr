#!/usr/bin/env python3

import argparse
import logging

from ..lexmapr.pipeline import run

logger = logging.getLogger("lexmapr")

script_name = path.basename(path.realpath(sys.argv[0]))

if __name__ == '__main__':
    parser = argparse.ArgumentParser()
    parser.add_argument('input_file',
                        help='Input csv file')
    parser.add_argument('-o', '--output', nargs='?',
                        help='Output file')
    parser.add_argument('log_file', nargs='?', default=sys.stderr,
                        help='Log file')
    parser.add_argument('-f', '--format', default='full',
                        help='Output format')
    parser.add_argument('--version', action='store_true', dest='version',
                        help='Prints version information.', required=False)
    args = parser.parse_args()
    
    if args.version:
        print(script_name + ' ' + __version__)
    elif args.command is None:
        parser.print_help()
    else:
        try:
            run(args)
        except CommandParseException as e:
            logger.error(str(e))
            e.get_parser().print_help()
